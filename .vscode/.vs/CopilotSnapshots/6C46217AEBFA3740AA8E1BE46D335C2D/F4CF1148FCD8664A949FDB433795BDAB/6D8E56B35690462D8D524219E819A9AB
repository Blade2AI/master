@echo off
echo ===============================================
echo  PrecisePointway Live Share Quick Setup
echo ===============================================
echo.

echo [1/4] Checking prerequisites...
where code >nul 2>&1
if %errorlevel% neq 0 (
    echo ❌ VS Code not found. Please install VS Code first.
    echo    Download: https://code.visualstudio.com/
    pause
    exit /b 1
) else (
    echo ✅ VS Code found
)

where git >nul 2>&1
if %errorlevel% neq 0 (
    echo ❌ Git not found. Please install Git first.
    echo    Download: https://git-scm.com/
    pause
    exit /b 1
) else (
    echo ✅ Git found
)

echo.
echo [2/4] Installing Live Share extension...
code --install-extension ms-vsliveshare.vsliveshare --force
if %errorlevel% equ 0 (
    echo ✅ Live Share extension installed
) else (
    echo ⚠️  Live Share extension installation may have failed
)

echo.
echo [3/4] Testing NAS connectivity...
if exist "\\dxp4800plus-67ba\ops" (
    echo ✅ NAS accessible
) else (
    echo ❌ Cannot access NAS at \\dxp4800plus-67ba\ops
    echo    Please check network connectivity and permissions
    pause
    exit /b 1
)

echo.
echo [4/4] Workspace setup...
if exist ".vscode\tasks.json" (
    echo ✅ VS Code tasks configured
) else (
    echo ⚠️  VS Code tasks not found - may need manual setup
)

echo.
echo ===============================================
echo  Setup Complete! 
echo ===============================================
echo.
echo 🎯 Next Steps:
echo.
echo   HOST PC (Start Session):
echo   1. Open VS Code in this workspace
echo   2. Ctrl+Shift+P ^> "Tasks: Run Task"
echo   3. Select "LiveShare: Start Host Session"
echo.
echo   GUEST PCs (Join Session):
echo   1. Open VS Code 
echo   2. Ctrl+Shift+P ^> "Tasks: Run Task" 
echo   3. Select "LiveShare: Join Session"
echo.
echo 💡 Tips:
echo   - Check session status with "LiveShare: Check Session Status"
echo   - Build C++ with "Build: C++ Debug" or "Build: C++ Release"
echo   - Monitor logs in %%USERPROFILE%%\LiveShareLogs\
echo.
echo Press any key to open VS Code...
pause >nul
code .